
<div class="grid" [style.height]="height + 10 + 'px'" [style.width]="width + 'px'" [style.grid-template-columns]="savedViews ? 'auto 250px' : 'auto'">
  <div class="table-wrapper">
    <div class="controls" [hidden]="!showFilters">
      <div class="sorters">
        Sorter:
        <button (click)="sortBy(field)" *ngFor="let field of sorterFields">
          <fa-icon *ngIf="model.hasSorter(field) === 'DESC'" [icon]="faSortAmountDown"></fa-icon>
          <fa-icon *ngIf="model.hasSorter(field) === 'ASC'" [icon]="faSortAmountDownAlt"></fa-icon>
          {{ field.displayName }}
          <fa-icon [icon]="faTimesCircle" class="close" (click)="sorterFields.delete(field); model.deleteSort(field)"></fa-icon>
        </button>
      </div>
      <div class="filters">
        Filter: <button *ngFor="let field of filterFields">{{ field.displayName }}<fa-icon [icon]="faTimesCircle" class="close" (click)="filterFields.delete(field)"></fa-icon></button>
      </div>
    </div>
    <div class="top-toolbar" *ngIf="topToolbarContent">
      <ng-content select=".top-toolbar"></ng-content>
    </div>
    <div class="table-scroll" [style.height]="height - (hasToolbar ? 40 : 0) - (showFilters || topToolbarContent ? 80 : 0) + 'px'">
      <table class="main-table" #table>
        <thead>
          <tr>
            <th class="table-header"
              *ngFor="let column of model.fields"
              [style.width]="column.width ? column.width + 'px' : rowWidth + 'px'"
              [hidden]="hiddenColumns.includes(column) || !column.displayName"
            >{{ column.displayName }}
            </th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of model.data">
            <td [hidden]="hiddenColumns.includes(column) || !column.displayName" *ngFor="let column of model.fields">{{ formatCellValue(row[column.name], column) }}</td>
          </tr>
        <tbody>
      </table>
    </div>
    <div class="loading" *ngIf="model.loading"></div>
  </div>
  <div class="toolbar" [style.height]="'40px'" [hidden]="!hasToolbar">
    <app-paginator *ngIf="paginator" [model]="model" [searchParams]="searchParams"></app-paginator>
    <ng-content select=".bottom-toolbar"></ng-content>
  </div>

  <!-- SAVED VIEWS -->
  <ng-container *ngIf="savedViews">
    <div class="columns" [style.height]="height - 250 + 'px'">
      <div class="columns-table-wrapper" [style.height]="height - 290 + 'px'">
        <table>
          <thead>
            <tr><th>Columns</th></tr>
          </thead>
          <tbody>
            <tr (click)="selectColumn(column)" [ngClass]="{'selected-row': isColumnSelected(column)}" *ngFor="let column of model.fields">
              <td>
                <input [checked]="isColumnSelected(column)" type="checkbox" class="column-checkbox">
                {{ column.displayName }}
              </td>
            </tr>
          <tbody>
        </table>
      </div>
      <div class="columns-toolbar" [style.height]="'40px'">
        <app-toolbar-button [disabled]="!selectedColumns.length" (click)="filterColumns()">Előnézet</app-toolbar-button>
        <app-toolbar-button [disabled]="!selectedColumns.length" (click)="selectedView ? createSavedView() : modalService.open('viewSaveModal')">Mentés</app-toolbar-button>
      </div>
    </div>
    <div class="saved-views" [style.height]="'250px'">
      <div class="saved-views-table-wrapper" [style.height]="'210px'">
        <table>
          <thead>
            <tr><th>Saved views</th></tr>
          </thead>
          <tbody>
            <tr (click)="selectView(view)" [ngClass]="{'selected-row': selectedView === view}" *ngFor="let view of savedViewCollection">
              <td>{{ view.name }}</td>
            </tr>
          <tbody>
        </table>
      </div>
      <div class="columns-toolbar" [style.height]="'40px'">
        <app-toolbar-button [disabled]="!selectedView" (click)="filterColumns()">Alkalmaz</app-toolbar-button>
        <app-toolbar-button [disabled]="!selectedView" (click)="deleteSavedView()">Törlés</app-toolbar-button>
        <app-toolbar-button (click)="selectedColumns = []; selectedView = null; filterColumns()">Alaphelyzetbe</app-toolbar-button>
      </div>
    </div>
    <app-modal id="viewSaveModal" [title]="'The name of the view'">
      Please enter the name:<br>
      <input type="text" [(ngModel)]="savedViewName"/>
      <div class="modal-footer">
        <app-button (click)="modalService.close('viewSaveModal')">Cancel</app-button>
        <app-button (click)="onSaveNewViewButtonClick()" [disabled]="!savedViewName">Save</app-button>
      </div>
    </app-modal>
  </ng-container>
</div>
<div id="drag-label"></div>
